var bulletUI=function(t){function e(){t.call(this),this.speedX=0,this.speedY=0,this.addEventListener(egret.Event.ADDED_TO_STAGE,this.onAddToStage,this)}__extends(e,t);var i=(__define,e),s=i.prototype;return s.onAddToStage=function(t){var e=RES.getRes("bulletJson"),i=RES.getRes("bullet"),s=new egret.MovieClipDataFactory(e,i);this.mc=new egret.MovieClip(s.generateMovieClipData("bullet")),this.addChild(this.mc),this.mc.frameRate=6,this.mc.play(-1),this.mc.anchorOffsetY=this.mc.height,this.mc.anchorOffsetX=.5*this.mc.width,this.mc.rotation=90},s.initDir=function(t){this.mc.rotation=90,this.mc.rotation=t+90},e}(egret.DisplayObjectContainer);egret.registerClass(bulletUI,"bulletUI");var cannonUI=function(t){function e(){t.call(this),this.addEventListener(egret.Event.ADDED_TO_STAGE,this.onAddToStage,this)}__extends(e,t);var i=(__define,e),s=i.prototype;return s.onAddToStage=function(t){var e=RES.getRes("cannonJson"),i=RES.getRes("cannon"),s=new egret.MovieClipDataFactory(e,i);this.mc=new egret.MovieClip(s.generateMovieClipData("cannon")),this.addChild(this.mc),this.mc.frameRate=6,this.mc.gotoAndStop(1),this.mc.anchorOffsetY=this.mc.height-10,this.mc.anchorOffsetX=.5*this.mc.width,this.mc.rotation=90},s.initFrame=function(t){this.mc.gotoAndStop(t)},e}(egret.DisplayObjectContainer);egret.registerClass(cannonUI,"cannonUI");var fish=function(t){function e(){t.call(this),this.speedX=0,this.speedY=0,this.dir=0,this.isMove=!0,this.isDie=!1,this.scoreArr=new Array(2,4,6,8),this.loop=0,this.addEventListener(egret.Event.ADDED_TO_STAGE,this.onAddToStage,this)}__extends(e,t);var i=(__define,e),s=i.prototype;return s.onAddToStage=function(t){},s.creatFish=function(){this.mc&&(this.removeChild(this.mc),this.mc.removeEventListener(egret.MovieClipEvent.FRAME_LABEL,this.onEnd,this),this.mc=null);var t=Math.floor(4*Math.random()+1);this.score=this.scoreArr[t-1];var e=RES.getRes("fish"+String(t)+"Json"),i=RES.getRes("fish"+String(t)),s=new egret.MovieClipDataFactory(e,i);this.mc=new egret.MovieClip(s.generateMovieClipData("fish"+String(t))),this.addChild(this.mc),this.mc.frameRate=6,this.mc.play(-1),this.mc.addEventListener(egret.MovieClipEvent.FRAME_LABEL,this.onEnd,this)},s.onEnd=function(t){"@liveEnd"==t.frameLabel&&t.currentTarget.gotoAndPlay(1),"@dieEnd"==t.frameLabel&&(t.currentTarget.gotoAndPlay(5),this.loop++,this.loop>2&&(this.isDie=!0,this.loop=0))},s.playDie=function(){this.mc.gotoAndPlay(5)},s.initDir=function(t){this.creatFish(),this.mc.gotoAndPlay(1),this.isDie=!1,this.isMove=!0,this.dir=t;var e=2,i=2;switch(t){case 1:this.speedX=e+Math.floor(3*Math.random())-1,this.speedY=Math.floor(3*Math.random())-1,this.mc.rotation=0;break;case 3:this.speedX=-e-Math.floor(3*Math.random())-1,this.speedY=Math.floor(3*Math.random())-1,this.mc.rotation=180;break;case 2:this.speedY=i+Math.floor(3*Math.random())-1,this.speedX=Math.floor(Math.random())-.5,this.mc.rotation=90;break;case 4:this.speedY=-i+Math.floor(3*Math.random())-1,this.speedX=Math.floor(Math.random())-.5,this.mc.rotation=-90}},e}(egret.DisplayObjectContainer);egret.registerClass(fish,"fish");var fishView=function(t){function e(){t.call(this),this.isLoop=!1,this.score=0,this.numNum=15,this.fishNum=25,this.bulletNum=25,this.webNum=25,this.numArr=new Array,this.numArrRun=new Array,this.numArrDie=new Array,this.webArr=new Array,this.webArrDie=new Array,this.webArrRun=new Array,this.fishArrLive=new Array,this.fishArrDie=new Array,this.bulletArr=new Array,this.bulletArrDie=new Array,this.bulletArrRun=new Array,this.bulletSpeed=15,this.spacing=-20,this.addEventListener(egret.Event.ADDED_TO_STAGE,this.onAddToStage,this)}__extends(e,t);var i=(__define,e),s=i.prototype;return s.onAddToStage=function(t){this.loadingView=new LoadingUI,this.stage.addChild(this.loadingView),RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.loadConfig("resource/fishGame.json","resource/")},s.onConfigComplete=function(t){RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),RES.loadGroup("preloadFish")},s.onResourceLoadComplete=function(t){"preloadFish"==t.groupName&&(this.stage.removeChild(this.loadingView),RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.removeEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.removeEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),this.createGameScene())},s.onItemLoadError=function(t){console.warn("Url:"+t.resItem.url+" has failed to load")},s.onResourceLoadError=function(t){console.warn("Group:"+t.groupName+" has failed to load"),this.onResourceLoadComplete(t)},s.onResourceProgress=function(t){"preloadFish"==t.groupName&&this.loadingView.setProgress(t.itemsLoaded,t.itemsTotal)},s.createGameScene=function(){this.sound||(this.sound=RES.getRes("bgMp3_b"),this.channel=this.sound.play());var t=util.createBitmapByName("bg_b");this.addChild(t),t.touchEnabled=!0;var e=this.stage.stageWidth,i=this.stage.stageHeight;t.width=e,t.height=i,t.touchEnabled=!0;var s=util.createBitmapByName("bottomBar_b");this.addChild(s),s.y=.5*i-.5*s.height,this.cannon=new cannonUI,this.addChild(this.cannon),this.cannon.y=s.y+428,this.stage.addEventListener(egret.TouchEvent.TOUCH_TAP,this.fire,this),this.addEventListener(egret.Event.ENTER_FRAME,this.onEnter,this),this.scoreMc=new scoreUI(6),this.scoreMc.setValue(this.score),this.scoreMc.rotation=90,this.scoreMc.x=s.x+30,this.scoreMc.y=s.y+40,this.addChild(this.scoreMc);var h=util.createBitmapByName("touch_main");h.name="add",h.width=50,h.height=50,this.addChild(h),h.y=s.y+488,h.touchEnabled=!0,h.addEventListener(egret.TouchEvent.TOUCH_TAP,this.changeBullet,this);var n=util.createBitmapByName("touch_main");n.name="low",n.width=50,n.height=50,this.addChild(n),n.y=s.y+343,n.touchEnabled=!0,n.addEventListener(egret.TouchEvent.TOUCH_TAP,this.changeBullet,this);for(var r=0;r<this.fishNum;r++){var a=new fish;this.fishArrDie.push(a)}for(var o=0;o<this.bulletNum;o++){var d=new bulletUI;this.bulletArr.push(d)}for(var l=0;l<this.webNum;l++){var u=new webUI;this.webArr.push(u)}for(var c=0;c<this.numNum;c++){var g=new numUI;this.numArr.push(g)}this.timer=new egret.Timer(400,this.fishNum),this.timer.addEventListener(egret.TimerEvent.TIMER,this.creatFish,this),this.timer.addEventListener(TimerEvent.TIMER_COMPLETE,this.creatFishEnd,this),this.timer.start()},s.creatFishEnd=function(t){this.isLoop=!0},s.creatFish=function(t){var e=this.fishArrDie.pop();return this.fishArrLive.push(e),this.addChild(e),void this.randomFish(e)},s.changeBullet=function(t){"add"==t.currentTarget.name&&this.cannon.mc.nextFrame(),"low"==t.currentTarget.name&&this.cannon.mc.prevFrame()},s.fire=function(t){var e=RES.getRes("b2");if(e.play(0,1),"add"!=t.target.name&&"low"!=t.target.name&&0!=this.bulletArr.length){var i,s=t.stageX-this.cannon.x,h=t.stageY-this.cannon.y,n=Math.atan(Math.abs(h/s));i=h>0?n/(2*Math.PI)*360:-n/(2*Math.PI)*360,this.cannon.rotation=i;var r=this.bulletArr.pop();h>0?r.speedY=Math.sin(n)*this.bulletSpeed:r.speedY=-Math.sin(n)*this.bulletSpeed,r.speedX=Math.abs(Math.cos(n))*this.bulletSpeed,this.bulletArrRun.push(r),this.addChild(r),r.mc.gotoAndStop(this.cannon.mc.currentFrame),r.initDir(i),r.x=this.cannon.x,r.y=this.cannon.y}},s.onEnter=function(t){for(var e=0;e<this.fishArrLive.length;e++){var i=this.fishArrLive[e];i.isMove&&(i.x+=i.speedX,i.y+=i.speedY),1==i.dir&&i.x>this.stage.stageWidth+this.spacing&&this.randomFish(i),3==i.dir&&i.x<-this.spacing&&this.randomFish(i),2==i.dir&&i.y>this.stage.stageHeight+this.spacing&&this.randomFish(i),4==i.dir&&i.y<-this.spacing&&this.randomFish(i),i.isDie&&this.randomFish(i)}for(var s=0;s<this.bulletArrRun.length;s++)this.bulletArrRun[s].x+=this.bulletArrRun[s].speedX,this.bulletArrRun[s].y+=this.bulletArrRun[s].speedY,(this.bulletArrRun[s].x>this.stage.stageWidth||this.bulletArrRun[s].y>this.stage.stageHeight||this.bulletArrRun[s].y<0)&&(util.contains(this.bulletArrDie,this.bulletArrRun[s])?console.log("bug!!!bb"):this.bulletArrDie.push(this.bulletArrRun[s]));for(var h=0;h<this.bulletArrRun.length;h++)for(var n=0;n<this.fishArrLive.length;n++)if(this.fishArrLive[n].isMove&&util.GameUtil.hitTest(this.bulletArrRun[h],this.fishArrLive[n])){if(this.fishArrLive[n].isMove=!1,this.fishArrLive[n].playDie(),this.webArr.length){var r=this.webArr.pop();this.webArrRun.push(r),this.addChild(r),r.initAnmat(),r.x=this.fishArrLive[n].x,r.y=this.fishArrLive[n].y}if(util.contains(this.bulletArrDie,this.bulletArrRun[h])?console.log("bug!!!"):this.bulletArrDie.push(this.bulletArrRun[h]),this.numArr.length){var a=this.numArr.pop();this.numArrRun.push(a),this.addChild(a),a.x=this.fishArrLive[n].x,a.y=this.fishArrLive[n].y,a.rotation=90,a.initNum(this.fishArrLive[n].score)}this.score+=this.fishArrLive[n].score,this.scoreMc.setValue(this.score)}for(;this.bulletArrDie.length>0;){var o=this.bulletArrDie.pop();this.removeChild(o),this.bulletArrRun.splice(this.bulletArrRun.indexOf(o),1),this.bulletArr.push(o)}for(var s=0;s<this.webArrRun.length;s++)this.webArrRun[s].isDie&&!util.contains(this.webArrDie,this.webArrRun[s])&&(this.webArrDie.push(this.webArrRun[s]),this.webArr.push(this.webArrRun[s]),this.webArrRun[s].isDie=!1);for(;this.webArrDie.length>0;){var r=this.webArrDie.pop();this.removeChild(r),this.webArrRun.splice(this.webArrRun.indexOf(o),1)}for(var d=0;d<this.numArrRun.length;d++)this.numArrRun[d].isDie&&!util.contains(this.numArrDie,this.numArrRun[d])&&(this.numArrDie.push(this.numArrRun[d]),this.numArr.push(this.numArrRun[d]),this.numArrRun[d].isDie=!1);for(;this.numArrDie.length>0;){var a=this.numArrDie.pop();this.removeChild(a),this.numArrRun.splice(this.numArrRun.indexOf(o),1)}},s.randomFish=function(t){var e=Math.floor(3*Math.random())+2;t.initDir(e);var i=-20;switch(e){case 1:t.x=i,t.y=(this.stage.stageHeight-2*t.height)*Math.random()+t.height;break;case 3:t.x=this.stage.stageWidth+i,t.y=(this.stage.stageHeight-2*t.height)*Math.random()+t.height;break;case 2:t.x=(this.stage.stageWidth-2*t.width)*Math.random()+t.width,t.y=-i;break;case 4:t.x=(this.stage.stageWidth-2*t.width)*Math.random()+t.width,t.y=this.stage.stageHeight+i}},s.gc=function(){this.channel.stop(),this.stage.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.fire,this),this.removeEventListener(egret.Event.ENTER_FRAME,this.onEnter,this)},e}(egret.DisplayObjectContainer);egret.registerClass(fishView,"fishView");var numUI=function(t){function e(){t.call(this),this.isDie=!1,this.addEventListener(egret.Event.ADDED_TO_STAGE,this.onAddToStage,this)}__extends(e,t);var i=(__define,e),s=i.prototype;return s.onAddToStage=function(t){var e=RES.getRes("numJson"),i=RES.getRes("num"),s=new egret.MovieClipDataFactory(e,i);this.numX=new egret.MovieClip(s.generateMovieClipData("num")),this.addChild(this.numX),this.numX.frameRate=6,this.numX.gotoAndStop(11),this.num=new egret.MovieClip(s.generateMovieClipData("num")),this.addChild(this.num),this.num.x=this.numX.width,this.num.frameRate=6,this.num.play(-1),this.name=String(Math.floor(100*Math.random()))},s.initNum=function(t){return 0!=this.num.y?void console.log("have this"):(this.isDie=!1,this.num.visible=this.numX.visible=!0,this.num.gotoAndStop(t+1),void this.addEventListener(egret.Event.ENTER_FRAME,this.onEnter,this))},s.onEnter=function(t){this.num.y-=3,this.numX.y-=3,this.num.y<-50&&(this.removeEventListener(egret.Event.ENTER_FRAME,this.onEnter,this),this.num.y=this.numX.y=0,this.num.visible=this.numX.visible=!1,this.isDie=!0)},e}(egret.DisplayObjectContainer);egret.registerClass(numUI,"numUI");var scoreUI=function(t){function e(e){t.call(this),this.val=0,this.mcArr=new Array,this.createView(e)}__extends(e,t);var i=(__define,e),s=i.prototype;return s.createView=function(t){for(var e=0;t>e;e++){var i=RES.getRes("scoreJson"),s=RES.getRes("score"),h=new egret.MovieClipDataFactory(i,s),n=new egret.MovieClip(h.generateMovieClipData("score"));n.frameRate=6,n.gotoAndStop(1),this.mcArr.push(n),n.x=(n.width+4)*e,this.addChild(n)}},s.getValue=function(){return this.val},s.setValue=function(t){this.val=t;for(var e=String(t),i=0;i<this.mcArr.length;i++)this.mcArr[i].gotoAndStop(0);for(var s,h=0;h<e.length;h++)s=e.substr(e.length-1-h,1),this.mcArr[this.mcArr.length-1-h].gotoAndStop(Number(s)+1),this.mcArr[this.mcArr.length-1-h].visible=!0},e}(egret.Sprite);egret.registerClass(scoreUI,"scoreUI");var webUI=function(t){function e(){t.call(this),this.isDie=!1,this.loop=0,this.addEventListener(egret.Event.ADDED_TO_STAGE,this.onAddToStage,this)}__extends(e,t);var i=(__define,e),s=i.prototype;return s.onAddToStage=function(t){var e=RES.getRes("webJson"),i=RES.getRes("web"),s=new egret.MovieClipDataFactory(e,i);this.mc=new egret.MovieClip(s.generateMovieClipData("web")),this.addChild(this.mc),this.mc.frameRate=6,this.mc.gotoAndStop(7),this.mc.anchorOffsetY=.5*this.mc.height,this.mc.anchorOffsetX=.5*this.mc.width},s.initAnmat=function(){this.isDie=!1,this.addEventListener(egret.Event.ENTER_FRAME,this.onEnter,this)},s.onEnter=function(t){this.mc.visible=!0,this.loop++,this.loop%10==1,this.loop>35&&(this.isDie=!0,this.loop=0,this.removeEventListener(egret.Event.ENTER_FRAME,this.onEnter,this),this.mc.visible=!1),console.log("enter",this.isDie)},e}(egret.DisplayObjectContainer);egret.registerClass(webUI,"webUI");var TimerEvent=egret.TimerEvent,fruitView=function(t){function e(){t.call(this),this.fruitArr=new Array(7,5,251,501,8,28,6,4,24,9,8,27,7,5,22,2,8,26,6,3,23,99,8,25),this.btnEnabled=!0,this.endPos=0,this.startPos=0,this.touzuTemp=0,this.allNum=1e5,this.dir=0,this.danjia=new Array(50,20,20,20,10,10,10,5),this.addEventListener(egret.Event.ADDED_TO_STAGE,this.onAddToStage,this)}__extends(e,t);var i=(__define,e),s=i.prototype;return s.onAddToStage=function(t){this.loadingView=new LoadingUI,this.stage.addChild(this.loadingView),RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.loadConfig("resource/fruitGame.json","resource/")},s.onConfigComplete=function(t){RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),RES.loadGroup("preloadFruit")},s.onResourceLoadComplete=function(t){"preloadFruit"==t.groupName&&(this.stage.removeChild(this.loadingView),RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.removeEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.removeEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),this.createGameScene())},s.onItemLoadError=function(t){console.warn("Url:"+t.resItem.url+" has failed to load")},s.onResourceLoadError=function(t){console.warn("Group:"+t.groupName+" has failed to load"),this.onResourceLoadComplete(t)},s.onResourceProgress=function(t){"preloadFruit"==t.groupName&&this.loadingView.setProgress(t.itemsLoaded,t.itemsTotal)},s.createGameScene=function(){this.sound||(this.sound=RES.getRes("bgMp3_f"),this.channel=this.sound.play());var t=util.createBitmapByName("bg_f");this.addChild(t);var e=this.stage.stageWidth,i=this.stage.stageHeight;t.width=e,t.height=i,t.touchEnabled=!0;var s=util.createBitmapByName("mask_f");this.addChild(s);var h=RES.getRes("lightjson_f"),n=RES.getRes("light_f"),r=new egret.MovieClipDataFactory(h,n);this.light=new egret.MovieClip(r.generateMovieClipData("l")),this.light.frameRate=6,this.light.play(-1),this.light.scaleX=this.light.scaleY=1.03,this.addChild(this.light);var a=util.createBitmapByName("body_f");a.x=.5*e-.5*a.width,a.y=.5*i-.5*a.height,this.addChild(a),this.light.x=.5*e-.5*this.light.width-5,this.light.y=a.y-38,s.x=.5*e-.5*s.width,s.y=a.y-78;var o=util.createBitmapByName("top_f");o.x=.5*e-.5*o.width,o.y=a.y-o.height-40,this.addChild(o);var d=util.createBitmapByName("btn_f");d.x=.5*e-.5*d.width,d.y=a.y+a.height+56,this.addChild(d),this.cmMc=new numMc(7),this.addChild(this.cmMc),this.zjMc=new numMc(7),this.addChild(this.zjMc),this.cmMc.y=this.zjMc.y=a.y+129,this.zjMc.x=a.x+83,this.cmMc.x=a.x+257,this.n1=new numMc(3),this.n2=new numMc(3),this.n3=new numMc(3),this.n4=new numMc(3),this.n5=new numMc(3),this.n6=new numMc(3),this.n7=new numMc(3),this.n8=new numMc(3),this.n1.y=this.n2.y=this.n3.y=this.n4.y=this.n5.y=this.n6.y=this.n7.y=this.n8.y=d.y+3,this.n1.x=31,this.n2.x=102,this.n3.x=175,this.n4.x=250,this.n5.x=330,this.n6.x=402,this.n7.x=475,this.n8.x=548,this.addChild(this.n1),this.addChild(this.n2),this.addChild(this.n3),this.addChild(this.n4),this.addChild(this.n5),this.addChild(this.n6),this.addChild(this.n7),this.addChild(this.n8);var l=RES.getRes("n1json_f"),u=RES.getRes("n1_f"),c=new egret.MovieClipDataFactory(l,u);this.num1=new egret.MovieClip(c.generateMovieClipData("num1")),this.num1.frameRate=6,this.num1.play(-1),this.num1.x=a.x+248,this.num1.y=a.y+335,this.addChild(this.num1);var g=RES.getRes("n1json_f"),m=RES.getRes("n1_f"),E=new egret.MovieClipDataFactory(g,m);this.num2=new egret.MovieClip(E.generateMovieClipData("num1")),this.num2.frameRate=6,this.num2.play(-1),this.num2.x=a.x+203,this.num2.y=a.y+335,this.addChild(this.num2);var v=RES.getRes("recjson_f"),p=RES.getRes("rec_f"),R=new egret.MovieClipDataFactory(v,p);this.rec=new egret.MovieClip(R.generateMovieClipData("rec")),this.rec.frameRate=10,this.rec.play(-1),this.addChild(this.rec),this.rec.x=this.recX=a.x-10,this.rec.y=this.recY=a.y-10;var x=RES.getRes("xzjson_f"),b=RES.getRes("xz_f"),f=new egret.MovieClipDataFactory(x,b);this.xz=new egret.MovieClip(f.generateMovieClipData("xz")),this.xz.frameRate=10,this.xz.play(-1),this.addChild(this.xz),this.xz.x=.5*e-.5*this.xz.width,this.xz.y=a.y+200,this.t1=new egret.TextField,this.t2=new egret.TextField,this.t3=new egret.TextField,this.t4=new egret.TextField,this.t5=new egret.TextField,this.t6=new egret.TextField,this.t7=new egret.TextField,this.t8=new egret.TextField,this.t1.y=this.t2.y=this.t3.y=this.t4.y=o.y+82,this.t5.y=this.t6.y=this.t7.y=this.t8.y=o.y+143,this.t1.x=this.t5.x=o.x+90,this.t2.x=this.t6.x=o.x+186,this.t3.x=this.t7.x=o.x+275,this.t4.x=this.t8.x=o.x+367,this.t1.textAlign=this.t2.textAlign=this.t3.textAlign=this.t4.textAlign=this.t5.textAlign=this.t6.textAlign=this.t7.textAlign=this.t8.textAlign="center",this.t1.text=this.t2.text=this.t3.text=this.t4.text=this.t5.text=this.t6.text=this.t7.text=this.t8.text="10",this.t1.size=this.t2.size=this.t3.size=this.t4.size=this.t5.size=this.t6.size=this.t7.size=this.t8.size=20,this.b1=util.createBitmapByName("touch"),this.addChild(this.b1),this.b2=util.createBitmapByName("touch"),this.addChild(this.b2),this.b3=util.createBitmapByName("touch"),this.addChild(this.b3),this.b4=util.createBitmapByName("touch"),this.addChild(this.b4),this.b5=util.createBitmapByName("touch"),this.addChild(this.b5),this.b6=util.createBitmapByName("touch"),this.addChild(this.b6),this.b7=util.createBitmapByName("touch"),this.addChild(this.b7),this.b8=util.createBitmapByName("touch"),this.addChild(this.b8),this.b1.width=this.b2.width=this.b3.width=this.b4.width=this.b5.width=this.b6.width=this.b7.width=this.b8.width=62,this.b1.height=this.b2.height=this.b3.height=this.b4.height=this.b5.height=this.b6.height=this.b7.height=this.b8.height=72,this.b1.y=this.b2.y=this.b3.y=this.b4.y=this.b5.y=this.b6.y=this.b7.y=this.b8.y=d.y+40,this.b1.touchEnabled=this.b2.touchEnabled=this.b3.touchEnabled=this.b4.touchEnabled=this.b5.touchEnabled=this.b6.touchEnabled=this.b7.touchEnabled=this.b8.touchEnabled=!0,this.b1.x=10,this.b2.x=88,this.b3.x=165,this.b4.x=245,this.b5.x=327,this.b6.x=410,this.b7.x=483,this.b8.x=558,this.b1.addEventListener(egret.TouchEvent.TOUCH_TAP,this.touzhu,this),this.b2.addEventListener(egret.TouchEvent.TOUCH_TAP,this.touzhu,this),this.b3.addEventListener(egret.TouchEvent.TOUCH_TAP,this.touzhu,this),this.b4.addEventListener(egret.TouchEvent.TOUCH_TAP,this.touzhu,this),this.b5.addEventListener(egret.TouchEvent.TOUCH_TAP,this.touzhu,this),this.b6.addEventListener(egret.TouchEvent.TOUCH_TAP,this.touzhu,this),this.b7.addEventListener(egret.TouchEvent.TOUCH_TAP,this.touzhu,this),this.b8.addEventListener(egret.TouchEvent.TOUCH_TAP,this.touzhu,this),this.startBtn=util.createBitmapByName("touch"),this.startBtn.x=377,this.startBtn.y=d.y+129,this.startBtn.width=180,this.startBtn.height=70,this.addChild(this.startBtn),this.startBtn.touchEnabled=!0,this.startBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onStart,this),this.clearBtn=util.createBitmapByName("touch"),this.clearBtn.x=95,this.clearBtn.y=d.y+129,this.clearBtn.width=180,this.clearBtn.height=70,this.addChild(this.clearBtn),this.clearBtn.touchEnabled=!0,this.clearBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClear,this);var y=RES.getRes("fruitjson_f"),T=RES.getRes("fruit_f"),C=new egret.MovieClipDataFactory(y,T);this.fruit=new egret.MovieClip(C.generateMovieClipData("test")),this.fruit.frameRate=6,this.fruit.x=a.x+205,this.fruit.y=a.y+205,this.fruit.anchorOffsetX=.5*this.fruit.width,this.fruit.anchorOffsetY=.5*this.fruit.height,this.addChild(this.fruit),this.fruit.visible=!1,this.initNum(),this.cmMc.setValue(1e6),this.timer=new egret.Timer(400,15),this.timer.addEventListener(egret.TimerEvent.TIMER,this.coutTime,this),this.timer.addEventListener(TimerEvent.TIMER_COMPLETE,this.timeOver,this),this.num1.gotoAndStop(1),this.num2.gotoAndStop(1)},s.coutTime=function(t){var e=15-t.currentTarget.currentCount;e>9?this.num2.gotoAndStop(2):this.num2.gotoAndStop(1),this.num1.gotoAndStop(e%10+1)},s.timeOver=function(t){this.timer.removeEventListener(egret.TimerEvent.TIMER,this.coutTime,this),this.timer.removeEventListener(TimerEvent.TIMER_COMPLETE,this.timeOver,this),this.endPos=50+Math.floor(20*Math.random()),this.startPos=0,this.addEventListener(egret.Event.ENTER_FRAME,this.gameViewUpdate,this)},s.onStart=function(t){this.endPos=50+Math.floor(20*Math.random()),this.startPos=0,this.addEventListener(egret.Event.ENTER_FRAME,this.gameViewUpdate,this),console.log("start")},s.onClear=function(t){console.log("clear"),this.allNum+=this.touzuTemp,this.touzuTemp=0,this.allNum>=0&&this.cmMc.setValue(this.allNum),this.n1.setValue(0),this.n2.setValue(0),this.n3.setValue(0),this.n4.setValue(0),this.n5.setValue(0),this.n6.setValue(0),this.n7.setValue(0),this.n8.setValue(0)},s.touzhu=function(t){var e=RES.getRes("coin_f");if(e.play(0,1),this.btnEnabled)switch(this.touzuTemp++,this.allNum--,this.allNum>=0&&this.cmMc.setValue(this.allNum),t.currentTarget){case this.b1:this.n1.setValue(this.n1.getValue()+1),this.t1.text=String(this.n1.getValue());break;case this.b2:this.n2.setValue(this.n2.getValue()+1),this.t2.text=String(this.n2.getValue());break;case this.b3:this.n3.setValue(this.n3.getValue()+1),this.t3.text=String(this.n3.getValue());break;case this.b4:this.n4.setValue(this.n4.getValue()+1),this.t4.text=String(this.n4.getValue());break;case this.b5:this.n5.setValue(this.n5.getValue()+1),this.t5.text=String(this.n5.getValue());break;case this.b6:this.n6.setValue(this.n6.getValue()+1),this.t6.text=String(this.n6.getValue());break;case this.b7:this.n7.setValue(this.n7.getValue()+1),this.t7.text=String(this.n7.getValue());break;case this.b8:this.n8.setValue(this.n8.getValue()+1),this.t8.text=String(this.n8.getValue())}},s.animationComplete=function(t){this.light.gotoAndPlay(1)},s.gameViewUpdate=function(t){this.btnEnabled=!1,0==this.startPos&&(this.dir=0,this.rec.x=this.recX,this.rec.y=this.recY),this.dir<6&&(this.rec.x+=70),this.dir<12&&this.dir>=6&&(this.rec.y+=70),this.dir<18&&this.dir>=12&&(this.rec.x-=70),this.dir<24&&this.dir>=18&&(this.rec.y-=70),this.dir++,24==this.dir&&(this.dir=0);var e=RES.getRes("run_f");e.play(0,1),this.startPos++,console.log(this.startPos,this.endPos),this.startPos==this.endPos&&(this.btnEnabled=!0,this.removeEventListener(egret.Event.ENTER_FRAME,this.gameViewUpdate,this),this.resultFun(),console.log("end!!!"))},s.resultFun=function(){this.touzuTemp=0;var t,e=this.fruitArr[this.endPos%24],i=e%10;if(9==i)t=1e3;else{var s=1;0!=Math.floor(e/10)&&(s=Math.floor(e/10)),t=this["n"+i].getValue()*this.danjia[i-1]*s}9!=i&&(this.fruit.gotoAndStop(i),this.fruit.visible=!0),this.xz.visible=!1,this.zjMc.setValue(t),this.cmMc.setValue(this.cmMc.getValue()+t),this.timerAnimate=new egret.Timer(400,10),this.timerAnimate.start(),this.timerAnimate.addEventListener(egret.TimerEvent.TIMER,this.onAnimate,this),this.timerAnimate.addEventListener(TimerEvent.TIMER_COMPLETE,this.AnimateOver,this)},s.onAnimate=function(t){console.log(t.currentTarget.currentCount%2),t.currentTarget.currentCount%2==1?this.fruit.scaleX=this.fruit.scaleY=1.1:this.fruit.scaleX=this.fruit.scaleY=1},s.AnimateOver=function(t){this.initNum(),this.fruit.visible=!1,this.xz.visible=!0},s.initNum=function(){this.n1.setValue(0),this.t1.text="0",this.n2.setValue(0),this.t2.text="0",this.n3.setValue(0),this.t3.text="0",this.n4.setValue(0),this.t4.text="0",this.n5.setValue(0),this.t5.text="0",this.n6.setValue(0),this.t6.text="0",this.n7.setValue(0),this.t7.text="0",this.n8.setValue(0),this.t8.text="0"},s.gc=function(){this.channel.stop()},e}(egret.DisplayObjectContainer);egret.registerClass(fruitView,"fruitView");var numMc=function(t){function e(e){t.call(this),this.val=0,this.mcArr=new Array,this.createView(e)}__extends(e,t);var i=(__define,e),s=i.prototype;return s.createView=function(t){for(var e=0;t>e;e++){var i=RES.getRes("n2json_f"),s=RES.getRes("n2_f"),h=new egret.MovieClipDataFactory(i,s),n=new egret.MovieClip(h.generateMovieClipData("num2"));n.frameRate=6,n.gotoAndStop(1),this.mcArr.push(n),n.x=n.width*e,this.addChild(n)}},s.getValue=function(){return this.val},s.setValue=function(t){this.val=t;for(var e=String(t),i=0;i<this.mcArr.length;i++)this.mcArr[i].$visible=!1;for(var s,h=0;h<e.length;h++)s=e.substr(e.length-1-h,1),this.mcArr[this.mcArr.length-1-h].gotoAndStop(Number(s)+1),this.mcArr[this.mcArr.length-1-h].visible=!0},e}(egret.Sprite);egret.registerClass(numMc,"numMc");var LoadingUI=function(t){function e(){t.call(this),this.eleArr=new Array,this.addEventListener(egret.Event.ADDED_TO_STAGE,this.onAddToStage,this),this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRemove,this)}__extends(e,t);var i=(__define,e),s=i.prototype;return s.onAddToStage=function(t){this.createView()},s.onRemove=function(t){this.removeEventListener(egret.Event.ENTER_FRAME,this.Update,this)},s.createView=function(){var t=util.createBitmapByName("alpha");t.width=this.stage.stageWidth,t.height=this.stage.stageHeight,t.touchEnabled=!0,this.addChild(t),this.textField=new egret.TextField,this.addChild(this.textField),this.textField.x=.5*this.stage.stageWidth,this.textField.y=.5*this.stage.stageHeight-.5*this.textField.height,this.textField.textAlign="center",this.con=new egret.DisplayObjectContainer;for(var e=0,i=.1,s=0;10>s;s++){var h=new egret.Shape;h.graphics.beginFill(16777215,i),h.graphics.drawCircle(0,0,10),h.graphics.endFill(),h.anchorOffsetX=-60,h.anchorOffsetY=.5*h.height,h.rotation=e,this.con.addChild(h),e+=36,i+=.1,this.eleArr.push(h)}this.addChild(this.con),this.con.x=.5*this.stage.stageWidth,this.con.y=.5*this.stage.stageHeight,this.addEventListener(egret.Event.ENTER_FRAME,this.Update,this)},s.Update=function(t){this.con.rotation+=36},s.setProgress=function(t,e){this.textField.text=t+"/"+e,this.textField.size=22,this.textField.x=.5*this.stage.stageWidth-.5*this.textField.width},e}(egret.Sprite);egret.registerClass(LoadingUI,"LoadingUI");var Main=function(t){function e(){t.call(this),this.vison=1,this.addEventListener(egret.Event.ADDED_TO_STAGE,this.onAddToStage,this)}__extends(e,t);var i=(__define,e),s=i.prototype;return s.onAddToStage=function(t){this.stage.dirtyRegionPolicy="off",this.loadingView=new LoadingUI,this.stage.addChild(this.loadingView),RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.loadConfig("resource/default.res.json","resource/")},s.onConfigComplete=function(t){RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),RES.loadGroup("preload")},s.onResourceLoadComplete=function(t){"preload"==t.groupName&&(this.stage.removeChild(this.loadingView),RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.removeEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.removeEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),this.createGameScene())},s.onItemLoadError=function(t){console.warn("Url:"+t.resItem.url+" has failed to load")},s.onResourceLoadError=function(t){console.warn("Group:"+t.groupName+" has failed to load"),this.onResourceLoadComplete(t)},s.onResourceProgress=function(t){"preload"==t.groupName&&this.loadingView.setProgress(t.itemsLoaded,t.itemsTotal)},s.createGameScene=function(){var t=this.createBitmapByName("bg_jpg");this.addChild(t);var e=this.stage.stageWidth,i=this.stage.stageHeight;t.width=e,t.height=i;var s=util.createBitmapByName("touch_main");s.name="fruit",s.width=500,s.height=120,this.addChild(s),s.y=.27*i,s.x=.5*e-.5*s.width,s.touchEnabled=!0,s.addEventListener(egret.TouchEvent.TOUCH_TAP,this.creatGame,this);var h=util.createBitmapByName("touch_main");h.name="slot",h.width=500,h.height=120,this.addChild(h),h.y=.5*i,h.x=.5*e-.5*s.width,h.touchEnabled=!0,h.addEventListener(egret.TouchEvent.TOUCH_TAP,this.creatGame,this);var n=util.createBitmapByName("touch_main");n.name="fish",n.width=500,n.height=120,this.addChild(n),n.y=.73*i,n.x=.5*e-.5*n.width,n.touchEnabled=!0,n.addEventListener(egret.TouchEvent.TOUCH_TAP,this.creatGame,this),this.gameCon=new egret.DisplayObjectContainer,this.addChild(this.gameCon),this.backBtn=util.createBitmapByName("back"),this.backBtn.x=e-this.backBtn.width,this.backBtn.y=i-this.backBtn.height,this.addChild(this.backBtn),this.backBtn.touchEnabled=!0,this.backBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.creatGame,this),this.backBtn.visible=!1,this.loginCon=new egret.DisplayObjectContainer;var r=this.createBitmapByName("alpha");this.loginCon.addChild(r),r.width=e,r.height=i,r.touchEnabled=!0,this.loginImg=this.createBitmapByName("login"),this.loginImg.x=.5*e-.5*this.loginImg.width,this.loginImg.y=.5*i-.5*this.loginImg.height-100,this.loginCon.addChild(this.loginImg),this.registerImg=this.createBitmapByName("regist"),this.registerImg.x=.5*e-.5*this.registerImg.width,this.registerImg.y=.5*i-.5*this.registerImg.height-100,this.loginCon.addChild(this.registerImg),this.registerImg.visible=!1,this.registerBtn=util.createBitmapByName("touch_main"),this.registerBtn.width=340,this.registerBtn.height=60,this.registerBtn.x=this.registerImg.x+30,this.registerBtn.y=this.registerImg.y+410,this.loginCon.addChild(this.registerBtn),this.registerBtn.touchEnabled=!0,this.registerBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.loginFun,this),this.loginBtn=util.createBitmapByName("touch_main"),this.loginBtn.width=340,this.loginBtn.height=60,this.loginBtn.x=this.registerImg.x+30,this.loginBtn.y=this.registerImg.y+320,this.loginCon.addChild(this.loginBtn),this.loginBtn.touchEnabled=!0,this.loginBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.loginFun,this),this.xBtn=util.createBitmapByName("touch_main"),this.xBtn.width=65,this.xBtn.height=65,this.xBtn.x=this.registerImg.x+this.registerImg.width-this.xBtn.width,this.xBtn.y=this.registerImg.y,this.loginCon.addChild(this.xBtn),this.xBtn.touchEnabled=!0,this.xBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.loginFun,this),this.nametxt=new egret.TextField,this.nametxt.type=egret.TextFieldType.INPUT,this.nametxt.inputType=egret.TextFieldInputType.TEXT,this.nametxt.text="用户名",this.nametxt.width=300,this.loginCon.addChild(this.nametxt),this.nametxt.y=this.registerImg.y+110,this.nametxt.x=this.registerImg.x+40,this.pass1txt=new egret.TextField,this.pass1txt.type=egret.TextFieldType.INPUT,this.pass1txt.inputType=egret.TextFieldInputType.PASSWORD,this.pass1txt.displayAsPassword=!0,this.pass1txt.text="输入密码:",this.pass1txt.y=this.registerImg.y+220,this.pass1txt.width=300,this.loginCon.addChild(this.pass1txt),this.pass1txt.x=this.registerImg.x+40,this.pass2txt=new egret.TextField,this.pass2txt.type=egret.TextFieldType.INPUT,this.pass2txt.displayAsPassword=!0,this.pass2txt.inputType=egret.TextFieldInputType.PASSWORD,this.pass2txt.text="确认密码",this.pass2txt.y=this.registerImg.y+325,this.pass2txt.width=300,this.loginCon.addChild(this.pass2txt),this.pass2txt.x=this.registerImg.x+40,this.pass2txt.visible=!1
},s.loginFun=function(t){switch(t.currentTarget){case this.xBtn:this.loginImg.visible=!0,this.registerImg.visible=!1,this.pass2txt.visible=!1,this.loginBtn.visible=!0;break;case this.loginBtn:if(""==this.nametxt.text||""==this.pass1txt.text)this.showMeg("账户和密码不能为空！");else{var e="name="+this.nametxt.text+"&pass="+this.pass1txt.text;new SendHttp("login.php",e,"GET",this,this.analyzeLogin)}break;case this.registerBtn:if(this.registerImg.visible)if(""==this.nametxt.text||""==this.pass1txt.text)this.showMeg("账户和密码不能为空！");else if(this.pass1txt.text==this.pass2txt.text){var e="name="+this.nametxt.text+"&pass="+this.pass1txt.text;new SendHttp("regist.php",e,"GET",this,this.analyzeRegister)}else this.showMeg("两次输入密码不一致！");else this.pass1txt.text="输入密码:",this.registerImg.visible=!0,this.loginImg.visible=!1,this.loginBtn.visible=!1,this.pass2txt.visible=!0}},s.analyzeLogin=function(t,e){console.log("data---","0"==t),"1"==t?(e.showMeg("登陆成功！"),e.loginCon.visible=!1):e.showMeg("密码或账户不正确！")},s.analyzeRegister=function(t,e){"1"==t?(e.showMeg("注册成功，请重新登陆！"),e.loginImg.visible=!0,e.registerImg.visible=!1,e.pass2txt.visible=!1,e.loginBtn.visible=!0):e.showMeg("注册失败，用户名已被注册！")},s.showMeg=function(t){this.mssageWin||(this.mssageWin=new MessageWin,this.addChild(this.mssageWin)),this.mssageWin.showMessage(t)},s.creatGame=function(t){"fruit"==t.currentTarget.name&&(this.gameObj=new fruitView),"slot"==t.currentTarget.name&&(this.gameObj=new slotView),"fish"==t.currentTarget.name&&(this.gameObj=new fishView),this.gameCon.addChild(this.gameObj),t.currentTarget==this.backBtn?(this.gameObj.gc(),this.gameCon.removeChildren(),this.backBtn.visible=!1):this.backBtn.visible=!0},s.createBitmapByName=function(t){var e=new egret.Bitmap,i=RES.getRes(t);return e.texture=i,e},e}(egret.DisplayObjectContainer);egret.registerClass(Main,"Main");var numBox=function(t){function e(e){t.call(this),this.speed=0,this.aSpeed=.2,this.maxSpeed=35,this.isStop=!1,this.aSpeed=e,this.createView()}__extends(e,t);var i=(__define,e),s=i.prototype;return s.createView=function(){this.part1=util.createBitmapByName("p1_s"),this.part2=util.createBitmapByName("p1_s"),this.part3=util.createBitmapByName("p1_s"),this.part4=util.createBitmapByName("p1_s"),this.addChild(this.part1),this.addChild(this.part2),this.addChild(this.part3),this.addChild(this.part4),this.part2.y=this.part1.y+this.part1.height,this.part3.y=this.part2.y+this.part2.height,this.part4.y=this.part3.y+this.part3.height},s.startRotate=function(){this.isStop=!1,this.addEventListener(egret.Event.ENTER_FRAME,this.onEnter,this)},s.initObj=function(t){this.removeChild(this[t]);var e=this[t].x,i=this[t].y,s=Math.floor(8*Math.random())+1;this[t]=util.createBitmapByName("p"+s+"_s"),this[t].x=e,this[t].y=i,this.addChild(this[t]),this[t].name=String(s)},s.stopRotate=function(){this.isStop=!0},s.onEnter=function(t){this.speed<this.maxSpeed&&(this.speed+=this.aSpeed),this.part1.y-=this.speed,this.part2.y-=this.speed,this.part3.y-=this.speed,this.part4.y-=this.speed,this.part1.y<=-125&&(this.part1.y=this.part4.y+this.part4.height,this.initObj("part1"),this.isStop&&this.removeEventListener(egret.Event.ENTER_FRAME,this.onEnter,this)),this.part2.y<=-125&&(this.part2.y=this.part1.y+this.part1.height,this.initObj("part2"),this.isStop&&this.removeEventListener(egret.Event.ENTER_FRAME,this.onEnter,this)),this.part3.y<=-125&&(this.part3.y=this.part2.y+this.part2.height,this.initObj("part3"),this.isStop&&this.removeEventListener(egret.Event.ENTER_FRAME,this.onEnter,this)),this.part4.y<=-125&&(this.part4.y=this.part3.y+this.part3.height,this.initObj("part4"),this.isStop&&this.removeEventListener(egret.Event.ENTER_FRAME,this.onEnter,this))},s.getID=function(){var t,e,i,s;this.part1.y>this.part2.y&&(t=this.part2.name,e=this.part3.name,i=this.part4.name,s=this.part1.name),this.part2.y>this.part3.y&&(t=this.part3.name,e=this.part4.name,i=this.part1.name,s=this.part2.name),this.part3.y>this.part4.y&&(t=this.part4.name,e=this.part1.name,i=this.part2.name,s=this.part3.name),this.part4.y>this.part1.y&&(t=this.part1.name,e=this.part2.name,i=this.part3.name,s=this.part4.name);var h=new Array(t,e,i,s);return h},e}(egret.Sprite);egret.registerClass(numBox,"numBox");var slotView=function(t){function e(){t.call(this),this.all=1e5,this.win=0,this.bet=0,this.prizeBeiArr=new Array(80,70,60,50,40,30,20,10),this.addEventListener(egret.Event.ADDED_TO_STAGE,this.onAddToStage,this)}__extends(e,t);var i=(__define,e),s=i.prototype;return s.onAddToStage=function(t){this.loadingView=new LoadingUI,this.stage.addChild(this.loadingView),RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.loadConfig("resource/slotGame.json","resource/")},s.onConfigComplete=function(t){RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),RES.loadGroup("preloadSlot")},s.onResourceLoadComplete=function(t){"preloadSlot"==t.groupName&&(this.stage.removeChild(this.loadingView),RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.removeEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.removeEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),this.createGameScene())},s.onItemLoadError=function(t){console.warn("Url:"+t.resItem.url+" has failed to load")},s.onResourceLoadError=function(t){console.warn("Group:"+t.groupName+" has failed to load"),this.onResourceLoadComplete(t)},s.onResourceProgress=function(t){"preloadSlot"==t.groupName&&this.loadingView.setProgress(t.itemsLoaded,t.itemsTotal)},s.createGameScene=function(){this.sound||(this.sound=RES.getRes("bgMp3_s"),this.channel=this.sound.play());var t=util.createBitmapByName("bg_s");this.addChild(t);var e=this.stage.stageWidth,i=this.stage.stageHeight;t.width=e,t.height=i,t.touchEnabled=!0;var s=util.createBitmapByName("mask");this.addChild(s),this.box1=new numBox(.3),this.addChild(this.box1),this.box2=new numBox(.2),this.addChild(this.box2),this.box3=new numBox(.15),this.addChild(this.box3);var h=util.createBitmapByName("body_s");this.addChild(h),h.x=.5*e-.5*h.width,h.y=i-h.height,s.x=h.x+85,s.y=h.y+180,this.box1.x=h.x+103,this.box1.y=h.y+212,this.box2.x=this.box1.x+this.box1.width,this.box2.y=h.y+212,this.box3.x=this.box2.x+this.box2.width,this.box3.y=h.y+212,this.allText=new egret.TextField,this.allText.x=h.x+410,this.allText.y=h.y+85,this.allText.text=String(this.all),this.addChild(this.allText),this.winText=new egret.TextField,this.winText.x=h.x+120,this.winText.y=h.y+617,this.winText.text=String(this.win),this.addChild(this.winText),this.betText=new egret.TextField,this.betText.x=h.x+390,this.betText.y=h.y+617,this.betText.text=String(this.bet),this.addChild(this.betText),this.allText.textAlign=this.winText.textAlign=this.betText.textAlign="right",this.allText.width=this.winText.width=this.betText.width=150,this.stopBtn=util.createBitmapByName("touch_s"),this.stopBtn.x=h.x+350,this.stopBtn.y=h.y+710,this.stopBtn.width=120,this.stopBtn.height=130,this.addChild(this.stopBtn),this.stopBtn.touchEnabled=!0,this.stopBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onStop,this),this.c1Btn=util.createBitmapByName("touch_s"),this.c1Btn.x=h.x+250,this.c1Btn.y=h.y+785,this.c1Btn.width=90,this.c1Btn.height=90,this.addChild(this.c1Btn),this.c1Btn.touchEnabled=!0,this.c1Btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onCost,this),this.c5Btn=util.createBitmapByName("touch_s"),this.c5Btn.x=h.x+145,this.c5Btn.y=h.y+785,this.c5Btn.width=90,this.c5Btn.height=90,this.addChild(this.c5Btn),this.c5Btn.touchEnabled=!0,this.c5Btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onCost,this),this.c10Btn=util.createBitmapByName("touch_s"),this.c10Btn.x=h.x+40,this.c10Btn.y=h.y+785,this.c10Btn.width=90,this.c10Btn.height=90,this.addChild(this.c10Btn),this.c10Btn.touchEnabled=!0,this.c10Btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onCost,this),this.clearBtn=util.createBitmapByName("touch_s"),this.clearBtn.x=h.x+50,this.clearBtn.y=h.y+710,this.clearBtn.width=130,this.clearBtn.height=50,this.addChild(this.clearBtn),this.clearBtn.touchEnabled=!0,this.clearBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onCost,this),this.maxBtn=util.createBitmapByName("touch_s"),this.maxBtn.x=h.x+200,this.maxBtn.y=h.y+710,this.maxBtn.width=130,this.maxBtn.height=50,this.addChild(this.maxBtn),this.maxBtn.touchEnabled=!0,this.maxBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onCost,this),this.startBtn=util.createBitmapByName("touch_s"),this.startBtn.x=h.x+490,this.startBtn.y=h.y+710,this.startBtn.width=120,this.startBtn.height=130,this.addChild(this.startBtn),this.startBtn.touchEnabled=!0,this.startBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onStart,this)},s.onCost=function(t){var e=RES.getRes("coin_s");switch(e.play(0,1),t.currentTarget){case this.c1Btn:this.all-1>=0&&(this.bet++,this.all--);break;case this.c5Btn:this.all-5>=0&&(this.bet+=5,this.all-=5);break;case this.c10Btn:this.all-10>=0&&(this.bet+=10,this.all-=10);break;case this.clearBtn:this.all+=this.bet,this.bet=0;break;case this.maxBtn:this.all+=this.bet,this.bet=this.all,this.all=0}this.allText.text=String(this.all),this.betText.text=String(this.bet)},s.onStop=function(t){this.box1.stopRotate(),this.box2.stopRotate(),this.box3.stopRotate();var e=RES.getRes("end_s");e.play(0,1),this.countResultTimer=new egret.Timer(1500,1),this.countResultTimer.start(),this.countResultTimer.addEventListener(TimerEvent.TIMER_COMPLETE,this.countResul,this)},s.countResul=function(t){var e=this.box1.getID(),i=this.box2.getID(),s=this.box3.getID();e[0]==i[0]&&i[0]==s[0]&&(this.win=this.bet*this.prizeBeiArr[Number(e[0])-1]),e[1]==i[1]&&i[1]==s[1]&&(this.win=this.bet*this.prizeBeiArr[Number(e[1])-1]),e[2]==i[2]&&i[2]==s[2]&&(this.win=this.bet*this.prizeBeiArr[Number(e[2])-1]),this.all+=this.win,this.bet=0,this.allText.text=String(this.all),this.betText.text=String(this.bet),this.winText.text=String(this.win)},s.onStart=function(t){this.win=0,this.winText.text=String(this.win),this.box1.startRotate(),this.box2.startRotate(),this.box3.startRotate();var e=RES.getRes("head_s");e.play(0,1)},s.gc=function(){this.channel.stop()},e}(egret.DisplayObjectContainer);egret.registerClass(slotView,"slotView");var util;!function(t){function e(t){var e=new egret.Bitmap,i=RES.getRes(t);return e.texture=i,e}function i(t,e,i){var s=t.graphics;s.beginFill(16777215),s.drawRect(0,0,e,i),s.endFill()}function s(t,e){for(var i=0;i<t.length;i++)if(t[i]===e)return!0;return!1}var h=function(){function t(){}var e=(__define,t);e.prototype;return t.hitTest=function(t,e){var i=t.getBounds(),s=e.getBounds();return i.x=t.x,i.y=t.y,s.x=e.x,s.y=e.y,i.intersects(s)},t}();t.GameUtil=h,egret.registerClass(h,"util.GameUtil"),t.createBitmapByName=e,t.drawRec=i,t.contains=s}(util||(util={}));var MessageWin=function(t){function e(){t.call(this),this.visible=!0,this.bg=new egret.Shape,this.addChild(this.bg),this.txt=new egret.TextField,this.addChild(this.txt)}__extends(e,t);var i=(__define,e),s=i.prototype;return s.showMessage=function(t){this.visible=!0,this.txt.textAlign="center",this.txt.size=25,this.txt.text="    "+t+"    ",this.txt.textColor=16777215,this.txt.y=.45*this.stage.stageHeight,this.txt.x=.5*this.stage.stageWidth-.5*this.txt.width,this.bg.graphics.clear(),this.bg.graphics.lineStyle(1,15658734),this.bg.graphics.beginFill(0,.5),this.bg.graphics.drawRoundRect(0,0,this.txt.width+20,this.txt.height+40,5,5),this.bg.graphics.endFill(),this.bg.x=.5*this.stage.stageWidth-.5*this.bg.width,this.bg.y=this.txt.y+.5*this.txt.height-.5*this.bg.height;var e=new egret.Timer(1500,1);e.start(),e.addEventListener(egret.TimerEvent.TIMER,this.overFun,this)},s.overFun=function(t){this.visible=!1},e}(egret.DisplayObjectContainer);egret.registerClass(MessageWin,"MessageWin");var game;!function(t){var e=function(t){function e(e,i,s){void 0===i&&(i=!1),void 0===s&&(s=!1),t.call(this,e,i,s)}__extends(e,t);var i=(__define,e);i.prototype;return e.GAME_RESULT="game_result",e.CLOSH_WIN="close_win",e.TIME_OUT="time_out",e.REQUEST_ERROR="request_error",e}(egret.Event);t.MyEvent=e,egret.registerClass(e,"game.MyEvent")}(game||(game={}));var game;!function(t){var e=function(t){function e(){t.call(this)}__extends(e,t);var i=(__define,e);i.prototype;return e.getInstance=function(){return null==this._instance&&(this._instance=new e),this._instance},e}(egret.EventDispatcher);t.MyEventDispatcher=e,egret.registerClass(e,"game.MyEventDispatcher")}(game||(game={}));var SendHttp=function(t){function e(e,i,s,h,n,r,a){void 0===n&&(n=null),void 0===r&&(r=null),void 0===a&&(a=null),t.call(this),this._comleteFun=n,this._errorFun=r,this._progressFun=a,this._obj=h;var o=new egret.HttpRequest;o.responseType=egret.HttpResponseType.TEXT,"POST"==s?o.open(e,egret.HttpMethod.POST):o.open(e+"?"+i,egret.HttpMethod.GET),o.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),"POST"==s?o.send(i):o.send(),o.addEventListener(egret.Event.COMPLETE,this.onComplete,this),o.addEventListener(egret.IOErrorEvent.IO_ERROR,this.onIOError,this),o.addEventListener(egret.ProgressEvent.PROGRESS,this.onProgress,this),this._startTime=egret.getTimer(),this.addEventListener(egret.Event.ENTER_FRAME,this.countTime,this)}__extends(e,t);var i=(__define,e),s=i.prototype;return s.onComplete=function(t){var e=t.currentTarget;e.removeEventListener(egret.Event.COMPLETE,this.onComplete,this),e.removeEventListener(egret.IOErrorEvent.IO_ERROR,this.onIOError,this),e.removeEventListener(egret.ProgressEvent.PROGRESS,this.onProgress,this),this.removeEventListener(egret.Event.ENTER_FRAME,this.countTime,this),this._comleteFun&&this._comleteFun(e.response,this._obj)},s.onIOError=function(t){console.log("post error : "+t),this._errorFun&&this._errorFun()},s.onProgress=function(t){this._progressFun&&this._progressFun()},s.countTime=function(){if(egret.getTimer()-this._startTime>5e3){console.log("超时----");var t=new game.MyEvent(game.MyEvent.TIME_OUT);game.MyEventDispatcher.getInstance().dispatchEvent(t),this.removeEventListener(egret.Event.ENTER_FRAME,this.countTime,this)}},e}(egret.DisplayObjectContainer);egret.registerClass(SendHttp,"SendHttp");